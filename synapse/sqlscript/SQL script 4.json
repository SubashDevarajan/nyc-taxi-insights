{
	"name": "SQL script 4",
	"properties": {
		"content": {
			"query": "CREATE OR ALTER VIEW dbo.nyc_taxi_trips1\nAS\nSELECT \n    trip_distance,\n    fare_amount,\n    total_amount,\n    trip_duration_minutes,\n    VendorID,\n    passenger_count,\n    RatecodeID,\n    store_and_fwd_flag,\n    PULocationID,\n    DOLocationID,\n    payment_type,\n    extra,\n    mta_tax,\n    tip_amount,\n    tolls_amount,\n    improvement_surcharge,\n    congestion_surcharge,\n    airport_fee,\n    ingest_time,\n    [source],\n    pickup_datetime,\n    dropoff_datetime,\n    passenger_bucket,\n    ratecode_desc,\n    payment_desc,\n    taxi_type,\n    [year],\n    [month],                     \n    tip_percent,\n    avg_speed_kmph,\n    duration_bucket,\n    net_revenue,\n    anomaly_flag\nFROM\nOPENROWSET(\n    BULK 'gold/parquet-trip-data/',   \n    DATA_SOURCE = 'nycadlssource',   \n    FORMAT = 'PARQUET'\n) \nWITH (\n    trip_distance FLOAT,\n    fare_amount FLOAT,\n    total_amount FLOAT,\n    trip_duration_minutes FLOAT,\n    VendorID BIGINT,\n    passenger_count FLOAT,\n    RatecodeID FLOAT,\n    store_and_fwd_flag VARCHAR(10),\n    PULocationID BIGINT,\n    DOLocationID BIGINT,\n    payment_type BIGINT,\n    extra FLOAT,\n    mta_tax FLOAT,\n    tip_amount FLOAT,\n    tolls_amount FLOAT,\n    improvement_surcharge FLOAT,\n    congestion_surcharge FLOAT,\n    airport_fee FLOAT,\n    ingest_time DATETIME2,\n    [source] VARCHAR(50),\n    pickup_datetime DATETIME2,\n    dropoff_datetime DATETIME2,\n    passenger_bucket VARCHAR(20),\n    ratecode_desc VARCHAR(50),\n    payment_desc VARCHAR(50),\n    taxi_type VARCHAR(20),\n    [year] INT,\n    [month] INT,\n    tip_percent FLOAT,\n    avg_speed_kmph FLOAT,\n    duration_bucket VARCHAR(20),\n    net_revenue FLOAT,\n    anomaly_flag BIGINT\n) AS nyctrips;\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "nyc_taxi",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}